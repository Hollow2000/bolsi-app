import{a as H}from"./chunk-MMTLHVHX.js";import{a as K}from"./chunk-ZBEO6VSQ.js";import{a as R,b as z,c as g,e as G,f as W,g as D,h as Y,m as Q,o as J,p as y}from"./chunk-XENJULYC.js";import{c as U,d as V,f as I,g as M,k as q}from"./chunk-7MYF4U2T.js";import{a as $}from"./chunk-V4IFG5G7.js";import"./chunk-7HPGID4D.js";import{a as B,b as j}from"./chunk-L46ZHKVX.js";import{d as L}from"./chunk-YHS6ELTG.js";import{a as v}from"./chunk-QWSRSP2M.js";import{$a as A,Aa as b,Ba as s,Ja as N,Oa as S,P as E,Ua as x,V as u,Va as O,W as _,Ya as F,_a as P,ab as n,bb as m,db as w,gb as p,hb as c,nb as C,ob as l,pb as f,tb as k,ub as T}from"./chunk-6WEJXUXI.js";import{f as h}from"./chunk-EQDQRRRY.js";var ee=(a,t)=>t.id;function te(a,t){if(a&1){let e=w();n(0,"h3",11),l(1,"Editar ingreso menusal"),m(),n(2,"div",12)(3,"input",20),p("keydown.enter",function(o){u(e);let r=C(5);return o.preventDefault(),_(r.focus())}),m(),n(4,"input",21,2),p("keydown.enter",function(o){u(e);let r=c().$implicit,d=c(2);return o.preventDefault(),_(d.submitEdit(r.id))}),m()(),n(6,"div",15)(7,"button",22),p("click",function(o){u(e);let r=c(3);return o.preventDefault(),_(r.cancelEdit())}),l(8," Cancelar "),n(9,"mat-icon",17),l(10),m()(),n(11,"button",23),p("click",function(o){u(e);let r=c().$implicit,d=c(2);return o.preventDefault(),_(d.submitEdit(r.id))}),l(12," Confirmar "),n(13,"mat-icon",17),l(14),m()()()}if(a&2){let e=c(3);s(3),x("formControl",e.incomeForm.controls.name),s(),x("formControl",e.incomeForm.controls.amountEstimated),s(6),f(e.Icons.CANCEL),s(4),f(e.Icons.CONFIRM)}}function ne(a,t){if(a&1){let e=w();n(0,"div",24)(1,"h3",11),l(2),m(),n(3,"span",25),l(4),k(5,"currency"),m()(),n(6,"div",26)(7,"button",27),p("click",function(o){u(e);let r=c().$implicit,d=C(1),Z=c(2);return o.preventDefault(),_(Z.openEdit(r,d))}),n(8,"mat-icon",28),l(9),m()(),n(10,"button",29),p("click",function(o){u(e);let r=c().$implicit,d=c(2);return o.preventDefault(),_(d.deleteIncome(r.id,r.name))}),n(11,"mat-icon",28),l(12),m()()()}if(a&2){let e=c().$implicit,i=c(2);s(2),f(e.name),s(2),f(T(5,4,e.amountEstimated)),s(5),f(i.Icons.EDIT),s(3),f(i.Icons.DELETE)}}function ie(a,t){if(a&1&&(n(0,"div",19,3),S(2,te,15,4)(3,ne,13,6),m()),a&2){let e=C(1),i=c(2);O("form",i.incomeEdit===e),x("@animate",void 0),s(2),F(i.incomeEdit===e?2:3)}}function oe(a,t){a&1&&(n(0,"div")(1,"div",30)(2,"h3",31),l(3,"Registra al menos un ingreso mensual."),m()()())}function re(a,t){if(a&1){let e=w();n(0,"div",4)(1,"h2",5),l(2,"Ingreso mensual:"),m(),n(3,"h2",5),l(4),k(5,"currency"),m()(),n(6,"div",6,0)(8,"div",7),P(9,ie,4,4,"div",8,ee,!1,oe,4,0,"div"),n(12,"app-add-element",9,1),p("onClose",function(){u(e);let o=c();return _(o.incomeForm.reset())}),n(14,"div",10)(15,"h3",11),l(16,"Nuevo ingreso menusal"),m(),n(17,"div",12)(18,"input",13),p("keydown.enter",function(){u(e);let o=C(20);return _(o.focus())}),m(),n(19,"input",14,2),p("keydown.enter",function(o){u(e);let r=C(13),d=c();return o.preventDefault(),_(d.submitNew(r))}),m()(),n(21,"div",15)(22,"button",16),p("click",function(o){u(e);let r=C(13),d=c();return o.preventDefault(),_(d.cancelNew(r))}),l(23," Cancelar "),n(24,"mat-icon",17),l(25),m()(),n(26,"button",18),p("click",function(o){u(e);let r=C(13),d=c();return o.preventDefault(),_(d.submitNew(r))}),l(27," Confirmar "),n(28,"mat-icon",17),l(29),m()()()()()()()}if(a&2){let e=c();s(4),f(T(5,7,e.incomes.incomeTotal)),s(5),A(e.incomes.list),s(3),x("@animate",void 0),s(6),x("formControl",e.incomeForm.controls.name),s(),x("formControl",e.incomeForm.controls.amountEstimated),s(6),f(e.Icons.CANCEL),s(4),f(e.Icons.CONFIRM)}}function ae(a,t){if(a&1&&(n(0,"div")(1,"h1",32),l(2),m()()),a&2){let e=c();s(2),f(e.errorMessage)}}var X=class a{incomeService=E(H);alertService=E(q);initialConfigService=E($);incomes;errorMessage;incomeForm=new W({name:new D(null,[g.required,g.minLength(5),g.maxLength(30)]),amountEstimated:new D(null,[g.required,g.maxLength(11)])});incomeEdit;get Icons(){return j}ngOnInit(){this.incomeService.getViewDataObservable().subscribe(t=>{this.incomes=t,t.incomeTotal!==0&&!this.initialConfigService.isDone?this.initialConfigService.setConfigDone(!0):t.incomeTotal===0&&this.initialConfigService.isDone&&this.initialConfigService.setConfigDone(!1)},t=>{this.errorMessage="Error al cargar los ingresos: "+t.message}),this.initialConfigService.nextPage=`${v.INIT_CONFIG}/${v.BILLS}`,this.initialConfigService.previousPage=`${v.INIT_CONFIG}/${v.PAYMENT_METHODS}`}outInteraction(t){this.incomeEdit&&!this.incomeEdit.contains(t.target)&&this.cancelEdit()}hasUnsaveChanges(){return this.incomes?.incomeTotal===0?(this.alertService.addInfo("Agrega al menos un ingreso para continuar."),!1):!0}submitNew(t){return h(this,null,function*(){this.incomeForm.valid?(yield this.incomeService.add({name:this.incomeForm.value.name,amountEstimated:y.clearNumberFormat(this.incomeForm.value.amountEstimated)}),this.incomeForm.reset(),t.writing=!1):this.incomeForm.markAllAsTouched()})}cancelNew(t){this.incomeForm.reset(),t.writing=!1}openEdit(t,e){this.incomeEdit=e,this.incomeForm.patchValue({name:t.name,amountEstimated:y.transformCurrencyFormat(t.amountEstimated)}),setTimeout(()=>{requestAnimationFrame(()=>{e.scrollIntoView({behavior:"smooth",block:"nearest"})})},100)}cancelEdit(){this.incomeForm.reset(),this.incomeEdit=void 0}submitEdit(t){return h(this,null,function*(){if(this.incomeForm.valid)try{yield this.incomeService.update(t,{name:this.incomeForm.value.name,amountEstimated:y.clearNumberFormat(this.incomeForm.value.amountEstimated)}),this.cancelEdit()}catch(e){this.alertService.addError("Error al actualizar el ingreso: "+(e?.message||e))}else this.incomeForm.markAllAsTouched()})}deleteIncome(t,e){return h(this,null,function*(){(yield this.alertService.addQuestionYoNDanger(`\xBFDesea eliminar ${e}?`,"Eliminar ingreso"))===2&&this.incomeService.delete(t)})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=N({type:a,selectors:[["app-income"]],hostBindings:function(e,i){e&1&&p("touchstart",function(r){return i.outInteraction(r)},!1,b)("mousedown",function(r){return i.outInteraction(r)},!1,b)},decls:2,vars:1,consts:[["scroll",""],["addElement",""],["amount",""],["item",""],[1,"header"],[1,"title-large"],[1,"scroll"],[1,"content"],[1,"card","income",3,"form"],["label","Agregar ingreso mensual",3,"onClose"],[1,"card","form"],[1,"title-small"],[1,"form"],["autocomplete","off","type","text","name","name","id","name","tabindex","1","placeholder","Nombre/Alias/Concepto",1,"text-medium","input",3,"keydown.enter","formControl"],["autocomplete","off","type","tel","name","amount","id","amount","placeholder","Cantidad","appCurrency","","tabindex","2",1,"text-medium","input",3,"keydown.enter","formControl"],[1,"buttons-add"],[1,"btn-danger",3,"click"],["fontSet","material-symbols-rounded",2,"font-size","24px","color","white"],[1,"btn-success",3,"click"],[1,"card","income"],["autocomplete","off","type","text","name","name","id","name","placeholder","Nombre/Alias/Concepto","tabindex","1","maxlength","30",1,"text-medium","input",3,"keydown.enter","formControl"],["autocomplete","off","type","tel","name","amount","id","amount","placeholder","Cantidad","appCurrency","","tabindex","2","maxlength","11",1,"text-medium","input",3,"keydown.enter","formControl"],["tabindex","3",1,"btn-danger",3,"click"],["tabindex","4",1,"btn-success",3,"click"],[1,"info"],[1,"text-large"],[1,"actions"],["id","edit",1,"btn-primary",3,"click"],["fontSet","material-symbols-rounded","color","white",2,"font-size","24px"],["id","delete",1,"btn-danger",3,"click"],[1,"card"],[1,"title-medium"],[1,"title-xlarge"]],template:function(e,i){e&1&&S(0,re,30,9)(1,ae,3,1,"div"),e&2&&F(i.incomes&&!i.errorMessage?0:1)},dependencies:[L,R,J,z,G,Q,Y,K,B],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:1rem;flex:1 1 auto;overflow:auto;margin:8px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.scroll[_ngcontent-%COMP%]{overflow-y:auto;flex:1 1 auto}.content[_ngcontent-%COMP%]{max-width:var(--max-width);margin:0 auto;display:grid;gap:1rem;align-items:start;width:95%;padding:8px}@media (min-width: 600px){.content[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1130px){.content[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.card.income[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:1rem}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:50%;display:flex;align-items:center;justify-content:center;padding:.5rem}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.buttons-add[_ngcontent-%COMP%]{display:flex;gap:1rem}.buttons-add[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;gap:1rem;padding:.5rem}"],data:{animation:[U("animate",[M(":enter",[I({opacity:0,transform:"scale(0.8)"}),V("200ms ease-out",I({opacity:1,transform:"scale(1)"}))]),M(":leave",[V("150ms ease-in",I({opacity:0,transform:"scale(0.8)"}))])])]}})};export{X as IncomeComponent};
